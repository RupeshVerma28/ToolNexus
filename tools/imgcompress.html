<!doctype html>
<html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Image Compressor</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="../style.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
</head><body>
<nav class="navbar tool-nav"><div class="container">
  <a class="tool-back" href="../index.html">&larr; Back</a>
</div></nav>
<main class="container my-4">
  <div class="card p-4 tool-card">
    <h3 class="mb-1">Image Compressor</h3>
    <p class="text-muted small">Client-side tool.</p>
    
<input id="imgs" type="file" accept="image/*" multiple class="form-control my-3">
<label>Quality: <span id="qval">80</span>%</label>
<input id="quality" type="range" min="10" max="100" value="80" class="form-range">
<button id="go" class="btn btn-primary mt-2">Compress & Download ZIP</button>
<div id="status" class="mt-3 text-muted small"></div>

  </div>
</main>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
<script>
const imgs = document.getElementById('imgs'), quality = document.getElementById('quality'), qval = document.getElementById('qval');
quality.addEventListener('input', ()=> qval.textContent = quality.value);
document.getElementById('go').addEventListener('click', async ()=>{
  const status = document.getElementById('status');
  if(!imgs.files.length){ alert('Select images'); return; }
  status.textContent = 'Compressing...';
  const zip = new JSZip();
  for(const f of imgs.files){
    const dataUrl = await new Promise(res=>{ const fr=new FileReader(); fr.onload=()=>res(fr.result); fr.readAsDataURL(f); });
    const img = new Image(); await new Promise(r=>{ img.onload=r; img.src=dataUrl; });
    const canvas = document.createElement('canvas'); canvas.width = img.width; canvas.height = img.height;
    const ctx = canvas.getContext('2d'); ctx.drawImage(img,0,0);
    const out = canvas.toDataURL('image/jpeg', parseInt(quality.value,10)/100);
    const blob = await (await fetch(out)).blob();
    zip.file('compressed-'+f.name.replace(/\s/g,'_')+'.jpg', blob);
  }
  const content = await zip.generateAsync({type:'blob'});
  const a = document.createElement('a'); a.href=URL.createObjectURL(content); a.download='images_compressed.zip'; a.click();
  status.textContent = 'Done â€” downloaded ZIP.';
});
</script>

</body></html>